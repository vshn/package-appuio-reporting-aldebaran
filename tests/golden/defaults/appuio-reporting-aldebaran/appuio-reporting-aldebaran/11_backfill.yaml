apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: appuiocloud-compute-cloudscaleflex
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: appuiocloud-compute-cloudscaleflex-0
  name: appuiocloud-compute-cloudscaleflex-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: appuiocloud-compute-cloudscaleflex
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: appuiocloud-compute-cloudscaleflex-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: appuiocloud-compute-cloudscaleflex
                - name: AR_QUERY
                  value: |
                    label_replace(
                      # Sum values over one hour.
                      sum_over_time(
                        # Average over a one-minute time frame.
                        # NOTE: This is a sliding window. Results vary based on the queries execution time.
                        avg_over_time(
                          clamp_min(
                            (
                              # Get the maximum of requested and used memory.
                              # TODO Is there a better way to get the maximum of two vectors?
                              (
                                # Select used memory if higher.
                                (
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (container_memory_working_set_bytes{image!="", cluster_id="c-appuio-cloudscale-lpg-2"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="flex"})))
                                  # IMPORTANT: one clause must use equal. If used grater and lesser than, equal values will be dropped.
                                  >=
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (kube_pod_container_resource_requests{resource="memory", cluster_id="c-appuio-cloudscale-lpg-2"}
                                    * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="flex"})))
                                )
                                or
                                # Select reserved memory if higher.
                                (
                                  # IMPORTANT: The desired time series must always be first.
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (kube_pod_container_resource_requests{resource="memory", cluster_id="c-appuio-cloudscale-lpg-2"}
                                    * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="flex"})))
                                  >
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (container_memory_working_set_bytes{image!="", cluster_id="c-appuio-cloudscale-lpg-2"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="flex"})))
                                )
                              )
                              # Add CPU requests in violation to the ratio provided by the platform.
                              + clamp_min(
                                # Convert CPU request to their memory equivalent.
                                sum by(cluster_id, namespace, label_appuio_io_node_class) (
                                  kube_pod_container_resource_requests{resource="cpu", cluster_id="c-appuio-cloudscale-lpg-2"} * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="flex"}))
                                  # CPU ratio depending on cluster
                                  * 4294967296
                                )
                                # Subtract memory request
                                - sum by(cluster_id, namespace, label_appuio_io_node_class) (kube_pod_container_resource_requests{resource="memory", cluster_id="c-appuio-cloudscale-lpg-2"}
                                  * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                  * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="flex"})))
                              # Only values above zero are in violation.
                              , 0)
                            )
                            *
                            # Join namespace label `label_appuio_io_organization` as `organization`.
                            on(cluster_id, namespace)
                            group_left(organization)
                            (
                              bottomk(1,
                                min by (cluster_id, namespace, organization) (
                                  label_replace(
                                    kube_namespace_labels{label_appuio_io_organization=~".+"},
                                    "organization",
                                    "$1",
                                    "label_appuio_io_organization", "(.*)"
                                  )
                                )
                              ) by(cluster_id, namespace)
                            )
                            *
                            # Join APPUiO organization info to get the `sales_order`
                            on(organization)
                            group_left(sales_order)
                            (
                              # Drop pod and instance labels so we gracefully handle
                              # short time periods (e.g. during maintenance) where it's
                              # possible that metrics are scraped from two control-api
                              # pods.
                              max without (pod,instance) (appuio_control_organization_info{namespace="appuio-control-api-production"})
                            ),
                            # At least return 128MiB
                            128 * 1024 * 1024
                          )[45s:15s]
                        )[59m:1m]
                      )
                      # Convert to MiB
                      / 1024 / 1024
                    , "name", "cloudscale.ch - LPG 2", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "appuio_cloud-compute-%(cluster_id)s-%(namespace)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Cloud - Zone:
                    %(name)s / Namespace: %(namespace)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_196_8b86c0c5
                - name: AR_ORG_ID
                  value: appuio-cloud-metering-c-appuio-cloudscale-lpg-2|appuio-cloud-metering-c-appuio-exoscale-ch-gva-2-0
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: appuiocloud-compute-cloudscaleplus
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: appuiocloud-compute-cloudscaleplus-1
  name: appuiocloud-compute-cloudscaleplus-1
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: appuiocloud-compute-cloudscaleplus
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: appuiocloud-compute-cloudscaleplus-1
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: appuiocloud-compute-cloudscaleplus
                - name: AR_QUERY
                  value: |
                    label_replace(
                      # Sum values over one hour.
                      sum_over_time(
                        # Average over a one-minute time frame.
                        # NOTE: This is a sliding window. Results vary based on the queries execution time.
                        avg_over_time(
                          clamp_min(
                            (
                              # Get the maximum of requested and used memory.
                              # TODO Is there a better way to get the maximum of two vectors?
                              (
                                # Select used memory if higher.
                                (
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (container_memory_working_set_bytes{image!="", cluster_id="c-appuio-cloudscale-lpg-2"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="plus"})))
                                  # IMPORTANT: one clause must use equal. If used grater and lesser than, equal values will be dropped.
                                  >=
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (kube_pod_container_resource_requests{resource="memory", cluster_id="c-appuio-cloudscale-lpg-2"}
                                    * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="plus"})))
                                )
                                or
                                # Select reserved memory if higher.
                                (
                                  # IMPORTANT: The desired time series must always be first.
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (kube_pod_container_resource_requests{resource="memory", cluster_id="c-appuio-cloudscale-lpg-2"}
                                    * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="plus"})))
                                  >
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (container_memory_working_set_bytes{image!="", cluster_id="c-appuio-cloudscale-lpg-2"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="plus"})))
                                )
                              )
                              # Add CPU requests in violation to the ratio provided by the platform.
                              + clamp_min(
                                # Convert CPU request to their memory equivalent.
                                sum by(cluster_id, namespace, label_appuio_io_node_class) (
                                  kube_pod_container_resource_requests{resource="cpu", cluster_id="c-appuio-cloudscale-lpg-2"} * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="plus"}))
                                  # CPU ratio depending on cluster
                                  * 4294967296
                                )
                                # Subtract memory request
                                - sum by(cluster_id, namespace, label_appuio_io_node_class) (kube_pod_container_resource_requests{resource="memory", cluster_id="c-appuio-cloudscale-lpg-2"}
                                  * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                  * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class="plus"})))
                              # Only values above zero are in violation.
                              , 0)
                            )
                            *
                            # Join namespace label `label_appuio_io_organization` as `organization`.
                            on(cluster_id, namespace)
                            group_left(organization)
                            (
                              bottomk(1,
                                min by (cluster_id, namespace, organization) (
                                  label_replace(
                                    kube_namespace_labels{label_appuio_io_organization=~".+"},
                                    "organization",
                                    "$1",
                                    "label_appuio_io_organization", "(.*)"
                                  )
                                )
                              ) by(cluster_id, namespace)
                            )
                            *
                            # Join APPUiO organization info to get the `sales_order`
                            on(organization)
                            group_left(sales_order)
                            (
                              # Drop pod and instance labels so we gracefully handle
                              # short time periods (e.g. during maintenance) where it's
                              # possible that metrics are scraped from two control-api
                              # pods.
                              max without (pod,instance) (appuio_control_organization_info{namespace="appuio-control-api-production"})
                            ),
                            # At least return 128MiB
                            128 * 1024 * 1024
                          )[45s:15s]
                        )[59m:1m]
                      )
                      # Convert to MiB
                      / 1024 / 1024
                    , "name", "cloudscale.ch - LPG 2", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "appuio_cloud-compute-%(cluster_id)s-%(namespace)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Cloud - Zone:
                    %(name)s / Namespace: %(namespace)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_196_8b86c0c5
                - name: AR_ORG_ID
                  value: appuio-cloud-metering-c-appuio-cloudscale-lpg-2|appuio-cloud-metering-c-appuio-exoscale-ch-gva-2-0
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: appuiocloud-compute-exoscalestandard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: appuiocloud-compute-exoscalestandard-2
  name: appuiocloud-compute-exoscalestandard-2
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: appuiocloud-compute-exoscalestandard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: appuiocloud-compute-exoscalestandard-2
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: appuiocloud-compute-exoscalestandard
                - name: AR_QUERY
                  value: |
                    label_replace(
                      # Sum values over one hour.
                      sum_over_time(
                        # Average over a one-minute time frame.
                        # NOTE: This is a sliding window. Results vary based on the queries execution time.
                        avg_over_time(
                          clamp_min(
                            (
                              # Get the maximum of requested and used memory.
                              # TODO Is there a better way to get the maximum of two vectors?
                              (
                                # Select used memory if higher.
                                (
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (container_memory_working_set_bytes{image!="", cluster_id="c-appuio-exoscale-ch-gva-2-0"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class=""})))
                                  # IMPORTANT: one clause must use equal. If used grater and lesser than, equal values will be dropped.
                                  >=
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (kube_pod_container_resource_requests{resource="memory", cluster_id="c-appuio-exoscale-ch-gva-2-0"}
                                    * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class=""})))
                                )
                                or
                                # Select reserved memory if higher.
                                (
                                  # IMPORTANT: The desired time series must always be first.
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (kube_pod_container_resource_requests{resource="memory", cluster_id="c-appuio-exoscale-ch-gva-2-0"}
                                    * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class=""})))
                                  >
                                  sum by(cluster_id, namespace, label_appuio_io_node_class) (container_memory_working_set_bytes{image!="", cluster_id="c-appuio-exoscale-ch-gva-2-0"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class=""})))
                                )
                              )
                              # Add CPU requests in violation to the ratio provided by the platform.
                              + clamp_min(
                                # Convert CPU request to their memory equivalent.
                                sum by(cluster_id, namespace, label_appuio_io_node_class) (
                                  kube_pod_container_resource_requests{resource="cpu", cluster_id="c-appuio-exoscale-ch-gva-2-0"} * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                    * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class=""}))
                                  # CPU ratio depending on cluster
                                  * 5333057536
                                )
                                # Subtract memory request
                                - sum by(cluster_id, namespace, label_appuio_io_node_class) (kube_pod_container_resource_requests{resource="memory", cluster_id="c-appuio-exoscale-ch-gva-2-0"}
                                  * on(uid, cluster_id, pod, namespace) group_left kube_pod_status_phase{phase="Running"}
                                  * on(cluster_id, node) group_left(label_appuio_io_node_class) (min by(cluster_id, node, label_appuio_io_node_class) (kube_node_labels{label_appuio_io_node_class=""})))
                              # Only values above zero are in violation.
                              , 0)
                            )
                            *
                            # Join namespace label `label_appuio_io_organization` as `organization`.
                            on(cluster_id, namespace)
                            group_left(organization)
                            (
                              bottomk(1,
                                min by (cluster_id, namespace, organization) (
                                  label_replace(
                                    kube_namespace_labels{label_appuio_io_organization=~".+"},
                                    "organization",
                                    "$1",
                                    "label_appuio_io_organization", "(.*)"
                                  )
                                )
                              ) by(cluster_id, namespace)
                            )
                            *
                            # Join APPUiO organization info to get the `sales_order`
                            on(organization)
                            group_left(sales_order)
                            (
                              # Drop pod and instance labels so we gracefully handle
                              # short time periods (e.g. during maintenance) where it's
                              # possible that metrics are scraped from two control-api
                              # pods.
                              max without (pod,instance) (appuio_control_organization_info{namespace="appuio-control-api-production"})
                            ),
                            # At least return 128MiB
                            128 * 1024 * 1024
                          )[45s:15s]
                        )[59m:1m]
                      )
                      # Convert to MiB
                      / 1024 / 1024
                    , "name", "Exoscale - CH-GVA-2 0", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "appuio_cloud-compute-%(cluster_id)s-%(namespace)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Cloud - Zone:
                    %(name)s / Namespace: %(namespace)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_196_8b86c0c5
                - name: AR_ORG_ID
                  value: appuio-cloud-metering-c-appuio-cloudscale-lpg-2|appuio-cloud-metering-c-appuio-exoscale-ch-gva-2-0
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 12 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: appuiocloud-loadbalancer-cloudscale
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: appuiocloud-loadbalancer-cloudscale-0
  name: appuiocloud-loadbalancer-cloudscale-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: appuiocloud-loadbalancer-cloudscale
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: appuiocloud-loadbalancer-cloudscale-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: appuiocloud-loadbalancer-cloudscale
                - name: AR_QUERY
                  value: |
                    label_replace(
                      # Sum values over one hour.
                      sum_over_time(
                        (
                          # Get number of services of type load balancer
                          sum by(cluster_id, namespace) (kube_service_spec_type{type="LoadBalancer", cluster_id="c-appuio-cloudscale-lpg-2"})
                          *
                          # Join the namespace label to get the tenant
                          on(cluster_id, namespace)
                          group_left(organization)
                          (
                            bottomk(1,
                              min by (cluster_id, namespace, organization) (
                                label_replace(
                                  kube_namespace_labels{label_appuio_io_organization=~".+"},
                                  "organization",
                                  "$1",
                                  "label_appuio_io_organization", "(.*)"
                                )
                              )
                            ) by(cluster_id, namespace)
                          )
                          *
                          on(organization)
                          group_left(sales_order)
                          (
                            # Drop pod and instance labels so we gracefully handle
                            # short time periods (e.g. during maintenance) where it's
                            # possible that metrics are scraped from two control-api
                            # pods.
                            max without (pod,instance) (appuio_control_organization_info{namespace="appuio-control-api-production"})
                          )
                        )[59m:1m]
                      )
                    , "name", "cloudscale.ch - LPG 2", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "appuio_cloud-lb-%(cluster_id)s-%(namespace)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Cloud - Zone:
                    %(name)s / Namespace: %(namespace)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_44_6c2bd44e
                - name: AR_ORG_ID
                  value: appuio-cloud-metering-c-appuio-cloudscale-lpg-2|appuio-cloud-metering-c-appuio-exoscale-ch-gva-2-0
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: appuiocloud-blockstorage-cloudscalebulk
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: appuiocloud-blockstorage-cloudscalebulk-0
  name: appuiocloud-blockstorage-cloudscalebulk-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: appuiocloud-blockstorage-cloudscalebulk
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: appuiocloud-blockstorage-cloudscalebulk-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: appuiocloud-blockstorage-cloudscalebulk
                - name: AR_QUERY
                  value: |
                    label_replace(
                      label_replace(
                        # Sum values over one hour.
                        sum_over_time(
                          clamp_min(
                            sum by(cluster_id, organization, namespace, storageclass, sales_order)(
                              # Get the PersistentVolume size
                              kube_persistentvolume_capacity_bytes
                              *
                              # Join the PersistentVolumeClaim to get the namespace
                              on (cluster_id,persistentvolume)
                              group_left(namespace, name)
                              label_replace(
                                kube_persistentvolume_claim_ref,
                                "namespace",
                                "$1",
                                "claim_namespace",
                                "(.+)(-.*)?"
                              )
                              *
                              # Join the PersistentVolume info to get StorageClass
                              on (cluster_id,persistentvolume)
                              group_left(storageclass)
                              # Do not differantiate between regular and encrypted storage class versions.
                              min by (cluster_id, persistentvolume, storageclass) (
                                label_replace(
                                  kube_persistentvolume_info{cluster_id="c-appuio-cloudscale-lpg-2",storageclass=~"bulk.*"},
                                  "storageclass",
                                  "$1",
                                  "storageclass",
                                  "([^-]+)-encrypted"
                                )
                              )
                              *
                              # Join the namespace label to get the tenant
                              on(cluster_id,namespace)
                              group_left(organization)
                              (
                                bottomk(1,
                                  min by (cluster_id, namespace, organization) (
                                    label_replace(
                                      kube_namespace_labels{label_appuio_io_organization=~".+"},
                                      "organization",
                                      "$1",
                                      "label_appuio_io_organization", "(.*)"
                                    )
                                  )
                                ) by(cluster_id, namespace)
                              )

                              *
                              # Join APPUiO organization info to get the `sales_order`
                              on(organization)
                              group_left(sales_order)
                              (
                                # Drop pod and instance labels so we gracefully handle
                                # short time periods (e.g. during maintenance) where it's
                                # possible that metrics are scraped from two control-api
                                # pods.
                                max without (pod,instance) (appuio_control_organization_info{namespace="appuio-control-api-production"})
                              )
                            ),
                            1024 * 1024 * 1024
                          )[59m:1m]
                        )
                        # Convert to MiB
                        / 1024 / 1024
                      , "name", "cloudscale.ch - LPG 2", "", "")
                    , "storage_type", "block", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "appuio_cloud-%(storage_type)sstorage-%(cluster_id)s-%(namespace)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Cloud - Zone:
                    %(name)s / Namespace: %(namespace)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_196_8b86c0c5
                - name: AR_ORG_ID
                  value: appuio-cloud-metering-c-appuio-cloudscale-lpg-2|appuio-cloud-metering-c-appuio-exoscale-ch-gva-2-0
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: appuiocloud-blockstorage-cloudscalessd
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: appuiocloud-blockstorage-cloudscalessd-1
  name: appuiocloud-blockstorage-cloudscalessd-1
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: appuiocloud-blockstorage-cloudscalessd
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: appuiocloud-blockstorage-cloudscalessd-1
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: appuiocloud-blockstorage-cloudscalessd
                - name: AR_QUERY
                  value: |
                    label_replace(
                      label_replace(
                        # Sum values over one hour.
                        sum_over_time(
                          clamp_min(
                            sum by(cluster_id, organization, namespace, storageclass, sales_order)(
                              # Get the PersistentVolume size
                              kube_persistentvolume_capacity_bytes
                              *
                              # Join the PersistentVolumeClaim to get the namespace
                              on (cluster_id,persistentvolume)
                              group_left(namespace, name)
                              label_replace(
                                kube_persistentvolume_claim_ref,
                                "namespace",
                                "$1",
                                "claim_namespace",
                                "(.+)(-.*)?"
                              )
                              *
                              # Join the PersistentVolume info to get StorageClass
                              on (cluster_id,persistentvolume)
                              group_left(storageclass)
                              # Do not differantiate between regular and encrypted storage class versions.
                              min by (cluster_id, persistentvolume, storageclass) (
                                label_replace(
                                  kube_persistentvolume_info{cluster_id="c-appuio-cloudscale-lpg-2",storageclass=~"ssd.*"},
                                  "storageclass",
                                  "$1",
                                  "storageclass",
                                  "([^-]+)-encrypted"
                                )
                              )
                              *
                              # Join the namespace label to get the tenant
                              on(cluster_id,namespace)
                              group_left(organization)
                              (
                                bottomk(1,
                                  min by (cluster_id, namespace, organization) (
                                    label_replace(
                                      kube_namespace_labels{label_appuio_io_organization=~".+"},
                                      "organization",
                                      "$1",
                                      "label_appuio_io_organization", "(.*)"
                                    )
                                  )
                                ) by(cluster_id, namespace)
                              )

                              *
                              # Join APPUiO organization info to get the `sales_order`
                              on(organization)
                              group_left(sales_order)
                              (
                                # Drop pod and instance labels so we gracefully handle
                                # short time periods (e.g. during maintenance) where it's
                                # possible that metrics are scraped from two control-api
                                # pods.
                                max without (pod,instance) (appuio_control_organization_info{namespace="appuio-control-api-production"})
                              )
                            ),
                            1024 * 1024 * 1024
                          )[59m:1m]
                        )
                        # Convert to MiB
                        / 1024 / 1024
                      , "name", "cloudscale.ch - LPG 2", "", "")
                    , "storage_type", "block", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "appuio_cloud-%(storage_type)sstorage-%(cluster_id)s-%(namespace)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Cloud - Zone:
                    %(name)s / Namespace: %(namespace)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_196_8b86c0c5
                - name: AR_ORG_ID
                  value: appuio-cloud-metering-c-appuio-cloudscale-lpg-2|appuio-cloud-metering-c-appuio-exoscale-ch-gva-2-0
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: appuiocloud-filestorage-cloudscalessd
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: appuiocloud-filestorage-cloudscalessd-2
  name: appuiocloud-filestorage-cloudscalessd-2
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: appuiocloud-filestorage-cloudscalessd
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: appuiocloud-filestorage-cloudscalessd-2
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: appuiocloud-filestorage-cloudscalessd
                - name: AR_QUERY
                  value: |
                    label_replace(
                      label_replace(
                        # Sum values over one hour.
                        sum_over_time(
                          clamp_min(
                            sum by(cluster_id, organization, namespace, storageclass, sales_order)(
                              # Get the PersistentVolume size
                              kube_persistentvolume_capacity_bytes
                              *
                              # Join the PersistentVolumeClaim to get the namespace
                              on (cluster_id,persistentvolume)
                              group_left(namespace, name)
                              label_replace(
                                kube_persistentvolume_claim_ref,
                                "namespace",
                                "$1",
                                "claim_namespace",
                                "(.+)(-.*)?"
                              )
                              *
                              # Join the PersistentVolume info to get StorageClass
                              on (cluster_id,persistentvolume)
                              group_left(storageclass)
                              # Do not differantiate between regular and encrypted storage class versions.
                              min by (cluster_id, persistentvolume, storageclass) (
                                label_replace(
                                  kube_persistentvolume_info{cluster_id="c-appuio-cloudscale-lpg-2",storageclass=~"cephfs-fspool-cluster"},
                                  "storageclass",
                                  "$1",
                                  "storageclass",
                                  "([^-]+)-encrypted"
                                )
                              )
                              *
                              # Join the namespace label to get the tenant
                              on(cluster_id,namespace)
                              group_left(organization)
                              (
                                bottomk(1,
                                  min by (cluster_id, namespace, organization) (
                                    label_replace(
                                      kube_namespace_labels{label_appuio_io_organization=~".+"},
                                      "organization",
                                      "$1",
                                      "label_appuio_io_organization", "(.*)"
                                    )
                                  )
                                ) by(cluster_id, namespace)
                              )

                              *
                              # Join APPUiO organization info to get the `sales_order`
                              on(organization)
                              group_left(sales_order)
                              (
                                # Drop pod and instance labels so we gracefully handle
                                # short time periods (e.g. during maintenance) where it's
                                # possible that metrics are scraped from two control-api
                                # pods.
                                max without (pod,instance) (appuio_control_organization_info{namespace="appuio-control-api-production"})
                              )
                            ),
                            1024 * 1024 * 1024
                          )[59m:1m]
                        )
                        # Convert to MiB
                        / 1024 / 1024
                      , "name", "cloudscale.ch - LPG 2", "", "")
                    , "storage_type", "file", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "appuio_cloud-%(storage_type)sstorage-%(cluster_id)s-%(namespace)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Cloud - Zone:
                    %(name)s / Namespace: %(namespace)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_196_8b86c0c5
                - name: AR_ORG_ID
                  value: appuio-cloud-metering-c-appuio-cloudscale-lpg-2|appuio-cloud-metering-c-appuio-exoscale-ch-gva-2-0
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 12 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: appuiocloud-blockstorage-exoscalessd
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: appuiocloud-blockstorage-exoscalessd-3
  name: appuiocloud-blockstorage-exoscalessd-3
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: appuiocloud-blockstorage-exoscalessd
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: appuiocloud-blockstorage-exoscalessd-3
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: appuiocloud-blockstorage-exoscalessd
                - name: AR_QUERY
                  value: |
                    label_replace(
                      label_replace(
                        # Sum values over one hour.
                        sum_over_time(
                          clamp_min(
                            sum by(cluster_id, organization, namespace, storageclass, sales_order)(
                              # Get the PersistentVolume size
                              kube_persistentvolume_capacity_bytes
                              *
                              # Join the PersistentVolumeClaim to get the namespace
                              on (cluster_id,persistentvolume)
                              group_left(namespace, name)
                              label_replace(
                                kube_persistentvolume_claim_ref,
                                "namespace",
                                "$1",
                                "claim_namespace",
                                "(.+)(-.*)?"
                              )
                              *
                              # Join the PersistentVolume info to get StorageClass
                              on (cluster_id,persistentvolume)
                              group_left(storageclass)
                              # Do not differantiate between regular and encrypted storage class versions.
                              min by (cluster_id, persistentvolume, storageclass) (
                                label_replace(
                                  kube_persistentvolume_info{cluster_id="c-appuio-exoscale-ch-gva-2-0",storageclass=~"rbd-storagepool-cluster"},
                                  "storageclass",
                                  "$1",
                                  "storageclass",
                                  "([^-]+)-encrypted"
                                )
                              )
                              *
                              # Join the namespace label to get the tenant
                              on(cluster_id,namespace)
                              group_left(organization)
                              (
                                bottomk(1,
                                  min by (cluster_id, namespace, organization) (
                                    label_replace(
                                      kube_namespace_labels{label_appuio_io_organization=~".+"},
                                      "organization",
                                      "$1",
                                      "label_appuio_io_organization", "(.*)"
                                    )
                                  )
                                ) by(cluster_id, namespace)
                              )

                              *
                              # Join APPUiO organization info to get the `sales_order`
                              on(organization)
                              group_left(sales_order)
                              (
                                # Drop pod and instance labels so we gracefully handle
                                # short time periods (e.g. during maintenance) where it's
                                # possible that metrics are scraped from two control-api
                                # pods.
                                max without (pod,instance) (appuio_control_organization_info{namespace="appuio-control-api-production"})
                              )
                            ),
                            1024 * 1024 * 1024
                          )[59m:1m]
                        )
                        # Convert to MiB
                        / 1024 / 1024
                      , "name", "Exoscale - CH-GVA-2 0", "", "")
                    , "storage_type", "block", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "appuio_cloud-%(storage_type)sstorage-%(cluster_id)s-%(namespace)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Cloud - Zone:
                    %(name)s / Namespace: %(namespace)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_196_8b86c0c5
                - name: AR_ORG_ID
                  value: appuio-cloud-metering-c-appuio-cloudscale-lpg-2|appuio-cloud-metering-c-appuio-exoscale-ch-gva-2-0
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 13 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: appuiocloud-filestorage-exoscalessd
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: appuiocloud-filestorage-exoscalessd-4
  name: appuiocloud-filestorage-exoscalessd-4
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: appuiocloud-filestorage-exoscalessd
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: appuiocloud-filestorage-exoscalessd-4
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: appuiocloud-filestorage-exoscalessd
                - name: AR_QUERY
                  value: |
                    label_replace(
                      label_replace(
                        # Sum values over one hour.
                        sum_over_time(
                          clamp_min(
                            sum by(cluster_id, organization, namespace, storageclass, sales_order)(
                              # Get the PersistentVolume size
                              kube_persistentvolume_capacity_bytes
                              *
                              # Join the PersistentVolumeClaim to get the namespace
                              on (cluster_id,persistentvolume)
                              group_left(namespace, name)
                              label_replace(
                                kube_persistentvolume_claim_ref,
                                "namespace",
                                "$1",
                                "claim_namespace",
                                "(.+)(-.*)?"
                              )
                              *
                              # Join the PersistentVolume info to get StorageClass
                              on (cluster_id,persistentvolume)
                              group_left(storageclass)
                              # Do not differantiate between regular and encrypted storage class versions.
                              min by (cluster_id, persistentvolume, storageclass) (
                                label_replace(
                                  kube_persistentvolume_info{cluster_id="c-appuio-exoscale-ch-gva-2-0",storageclass=~"cephfs-fspool-cluster"},
                                  "storageclass",
                                  "$1",
                                  "storageclass",
                                  "([^-]+)-encrypted"
                                )
                              )
                              *
                              # Join the namespace label to get the tenant
                              on(cluster_id,namespace)
                              group_left(organization)
                              (
                                bottomk(1,
                                  min by (cluster_id, namespace, organization) (
                                    label_replace(
                                      kube_namespace_labels{label_appuio_io_organization=~".+"},
                                      "organization",
                                      "$1",
                                      "label_appuio_io_organization", "(.*)"
                                    )
                                  )
                                ) by(cluster_id, namespace)
                              )

                              *
                              # Join APPUiO organization info to get the `sales_order`
                              on(organization)
                              group_left(sales_order)
                              (
                                # Drop pod and instance labels so we gracefully handle
                                # short time periods (e.g. during maintenance) where it's
                                # possible that metrics are scraped from two control-api
                                # pods.
                                max without (pod,instance) (appuio_control_organization_info{namespace="appuio-control-api-production"})
                              )
                            ),
                            1024 * 1024 * 1024
                          )[59m:1m]
                        )
                        # Convert to MiB
                        / 1024 / 1024
                      , "name", "Exoscale - CH-GVA-2 0", "", "")
                    , "storage_type", "file", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "appuio_cloud-%(storage_type)sstorage-%(cluster_id)s-%(namespace)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Cloud - Zone:
                    %(name)s / Namespace: %(namespace)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_196_8b86c0c5
                - name: AR_ORG_ID
                  value: appuio-cloud-metering-c-appuio-cloudscale-lpg-2|appuio-cloud-metering-c-appuio-exoscale-ch-gva-2-0
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 14 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshiftoke-baremetal-core-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshiftoke-baremetal-core-besteffort-0
  name: openshiftoke-baremetal-core-besteffort-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshiftoke-baremetal-core-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshiftoke-baremetal-core-besteffort-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshiftoke-baremetal-core-besteffort
                - name: AR_QUERY
                  value: |
                    # Calculates cores for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node cores (without hyperthreads, otherwise we'd
                          # include `cpu` in the `by`)
                          max by (cluster_id, instance, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (cluster_id, instance, role) (
                                  label_join(kube_node_role{role="worker"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"baremetal",
                        distribution=~"oke",
                        vshn_service_level="best_effort",
                      }
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cores-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_198_02905845
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshiftoke-baremetal-core-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshiftoke-baremetal-core-guaranteed-1
  name: openshiftoke-baremetal-core-guaranteed-1
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshiftoke-baremetal-core-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshiftoke-baremetal-core-guaranteed-1
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshiftoke-baremetal-core-guaranteed
                - name: AR_QUERY
                  value: |
                    # Calculates cores for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node cores (without hyperthreads, otherwise we'd
                          # include `cpu` in the `by`)
                          max by (cluster_id, instance, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (cluster_id, instance, role) (
                                  label_join(kube_node_role{role="worker"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"baremetal",
                        distribution=~"oke",
                        vshn_service_level="guaranteed_availability",
                      }
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cores-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_198_02905845
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-storagevcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-storagevcpu-besteffort-0
  name: openshift-cloudscale-storagevcpu-besteffort-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-storagevcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-storagevcpu-besteffort-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-storagevcpu-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"openshift4",
                        vshn_service_level="best_effort",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-storagevcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-storagevcpu-guaranteed-1
  name: openshift-cloudscale-storagevcpu-guaranteed-1
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-storagevcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-storagevcpu-guaranteed-1
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-storagevcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"openshift4",
                        vshn_service_level="guaranteed_availability",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-storagevcpu-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-storagevcpu-premium-2
  name: openshift-cloudscale-storagevcpu-premium-2
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-storagevcpu-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-storagevcpu-premium-2
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-storagevcpu-premium
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"openshift4",
                        vshn_service_level="premium",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 12 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-storagevcpu-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-storagevcpu-professional-3
  name: openshift-cloudscale-storagevcpu-professional-3
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-storagevcpu-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-storagevcpu-professional-3
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-storagevcpu-professional
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"openshift4",
                        vshn_service_level="professional",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 13 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-storagevcpu-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-storagevcpu-standard-4
  name: openshift-cloudscale-storagevcpu-standard-4
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-storagevcpu-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-storagevcpu-standard-4
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-storagevcpu-standard
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"openshift4",
                        vshn_service_level="standard",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 14 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-workervcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-workervcpu-besteffort-5
  name: openshift-cloudscale-workervcpu-besteffort-5
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-workervcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-workervcpu-besteffort-5
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-workervcpu-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"openshift4",
                        vshn_service_level="best_effort",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 15 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-workervcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-workervcpu-guaranteed-6
  name: openshift-cloudscale-workervcpu-guaranteed-6
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-workervcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-workervcpu-guaranteed-6
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-workervcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"openshift4",
                        vshn_service_level="guaranteed_availability",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 16 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-workervcpu-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-workervcpu-premium-7
  name: openshift-cloudscale-workervcpu-premium-7
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-workervcpu-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-workervcpu-premium-7
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-workervcpu-premium
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"openshift4",
                        vshn_service_level="premium",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 17 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-workervcpu-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-workervcpu-professional-8
  name: openshift-cloudscale-workervcpu-professional-8
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-workervcpu-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-workervcpu-professional-8
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-workervcpu-professional
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"openshift4",
                        vshn_service_level="professional",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 18 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-workervcpu-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-workervcpu-standard-9
  name: openshift-cloudscale-workervcpu-standard-9
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-workervcpu-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-workervcpu-standard-9
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-workervcpu-standard
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"openshift4",
                        vshn_service_level="standard",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 19 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-workervcpu-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-workervcpu-zero-10
  name: openshift-cloudscale-workervcpu-zero-10
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-workervcpu-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-workervcpu-zero-10
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-workervcpu-zero
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"openshift4",
                        vshn_service_level="zero",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 20 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshiftoke-cloudscale-workervcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshiftoke-cloudscale-workervcpu-besteffort-11
  name: openshiftoke-cloudscale-workervcpu-besteffort-11
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshiftoke-cloudscale-workervcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshiftoke-cloudscale-workervcpu-besteffort-11
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshiftoke-cloudscale-workervcpu-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"oke",
                        vshn_service_level="best_effort",
                      }
                    )
                    , "flavor_display", "Kubernetes Engine", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 21 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshiftoke-cloudscale-workervcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshiftoke-cloudscale-workervcpu-guaranteed-12
  name: openshiftoke-cloudscale-workervcpu-guaranteed-12
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshiftoke-cloudscale-workervcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshiftoke-cloudscale-workervcpu-guaranteed-12
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshiftoke-cloudscale-workervcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"cloudscale",
                        distribution=~"oke",
                        vshn_service_level="guaranteed_availability",
                      }
                    )
                    , "flavor_display", "Kubernetes Engine", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 22 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-storagevcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-storagevcpu-besteffort-13
  name: openshift-exoscale-storagevcpu-besteffort-13
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-storagevcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-storagevcpu-besteffort-13
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-storagevcpu-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"exoscale",
                        distribution=~"openshift4",
                        vshn_service_level="best_effort",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 23 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-storagevcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-storagevcpu-guaranteed-14
  name: openshift-exoscale-storagevcpu-guaranteed-14
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-storagevcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-storagevcpu-guaranteed-14
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-storagevcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"exoscale",
                        distribution=~"openshift4",
                        vshn_service_level="guaranteed_availability",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 24 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-storagevcpu-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-storagevcpu-premium-15
  name: openshift-exoscale-storagevcpu-premium-15
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-storagevcpu-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-storagevcpu-premium-15
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-storagevcpu-premium
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"exoscale",
                        distribution=~"openshift4",
                        vshn_service_level="premium",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 25 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-storagevcpu-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-storagevcpu-professional-16
  name: openshift-exoscale-storagevcpu-professional-16
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-storagevcpu-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-storagevcpu-professional-16
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-storagevcpu-professional
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"exoscale",
                        distribution=~"openshift4",
                        vshn_service_level="professional",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 26 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-storagevcpu-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-storagevcpu-standard-17
  name: openshift-exoscale-storagevcpu-standard-17
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-storagevcpu-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-storagevcpu-standard-17
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-storagevcpu-standard
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"exoscale",
                        distribution=~"openshift4",
                        vshn_service_level="standard",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 27 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-workervcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-workervcpu-besteffort-18
  name: openshift-exoscale-workervcpu-besteffort-18
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-workervcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-workervcpu-besteffort-18
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-workervcpu-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"exoscale",
                        distribution=~"openshift4",
                        vshn_service_level="best_effort",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 28 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-workervcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-workervcpu-guaranteed-19
  name: openshift-exoscale-workervcpu-guaranteed-19
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-workervcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-workervcpu-guaranteed-19
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-workervcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"exoscale",
                        distribution=~"openshift4",
                        vshn_service_level="guaranteed_availability",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 29 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-workervcpu-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-workervcpu-premium-20
  name: openshift-exoscale-workervcpu-premium-20
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-workervcpu-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-workervcpu-premium-20
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-workervcpu-premium
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"exoscale",
                        distribution=~"openshift4",
                        vshn_service_level="premium",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 30 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-workervcpu-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-workervcpu-professional-21
  name: openshift-exoscale-workervcpu-professional-21
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-workervcpu-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-workervcpu-professional-21
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-workervcpu-professional
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"exoscale",
                        distribution=~"openshift4",
                        vshn_service_level="professional",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 31 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-workervcpu-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-workervcpu-standard-22
  name: openshift-exoscale-workervcpu-standard-22
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-workervcpu-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-workervcpu-standard-22
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-workervcpu-standard
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"exoscale",
                        distribution=~"openshift4",
                        vshn_service_level="standard",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 32 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-workervcpu-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-workervcpu-zero-23
  name: openshift-exoscale-workervcpu-zero-23
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-workervcpu-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-workervcpu-zero-23
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-workervcpu-zero
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"exoscale",
                        distribution=~"openshift4",
                        vshn_service_level="zero",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 33 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackcsp-workervcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackcsp-workervcpu-besteffort-24
  name: openshift-openstackcsp-workervcpu-besteffort-24
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackcsp-workervcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackcsp-workervcpu-besteffort-24
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackcsp-workervcpu-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstackcsp",
                        distribution=~"openshift4",
                        vshn_service_level="best_effort",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 34 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackcsp-workervcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackcsp-workervcpu-guaranteed-25
  name: openshift-openstackcsp-workervcpu-guaranteed-25
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackcsp-workervcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackcsp-workervcpu-guaranteed-25
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackcsp-workervcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstackcsp",
                        distribution=~"openshift4",
                        vshn_service_level="guaranteed_availability",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 35 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackcsp-workervcpu-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackcsp-workervcpu-premium-26
  name: openshift-openstackcsp-workervcpu-premium-26
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackcsp-workervcpu-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackcsp-workervcpu-premium-26
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackcsp-workervcpu-premium
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstackcsp",
                        distribution=~"openshift4",
                        vshn_service_level="premium",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 36 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackcsp-workervcpu-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackcsp-workervcpu-professional-27
  name: openshift-openstackcsp-workervcpu-professional-27
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackcsp-workervcpu-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackcsp-workervcpu-professional-27
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackcsp-workervcpu-professional
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstackcsp",
                        distribution=~"openshift4",
                        vshn_service_level="professional",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 37 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackcsp-workervcpu-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackcsp-workervcpu-standard-28
  name: openshift-openstackcsp-workervcpu-standard-28
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackcsp-workervcpu-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackcsp-workervcpu-standard-28
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackcsp-workervcpu-standard
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstackcsp",
                        distribution=~"openshift4",
                        vshn_service_level="standard",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 38 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackcsp-workervcpu-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackcsp-workervcpu-zero-29
  name: openshift-openstackcsp-workervcpu-zero-29
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackcsp-workervcpu-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackcsp-workervcpu-zero-29
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackcsp-workervcpu-zero
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstackcsp",
                        distribution=~"openshift4",
                        vshn_service_level="zero",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 39 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackonprem-workervcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackonprem-workervcpu-besteffort-30
  name: openshift-openstackonprem-workervcpu-besteffort-30
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackonprem-workervcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackonprem-workervcpu-besteffort-30
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackonprem-workervcpu-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstack|openstackonprem",
                        distribution=~"openshift4",
                        vshn_service_level="best_effort",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 40 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackonprem-workervcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackonprem-workervcpu-guaranteed-31
  name: openshift-openstackonprem-workervcpu-guaranteed-31
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackonprem-workervcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackonprem-workervcpu-guaranteed-31
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackonprem-workervcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstack|openstackonprem",
                        distribution=~"openshift4",
                        vshn_service_level="guaranteed_availability",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 41 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackonprem-workervcpu-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackonprem-workervcpu-premium-32
  name: openshift-openstackonprem-workervcpu-premium-32
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackonprem-workervcpu-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackonprem-workervcpu-premium-32
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackonprem-workervcpu-premium
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstack|openstackonprem",
                        distribution=~"openshift4",
                        vshn_service_level="premium",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 42 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackonprem-workervcpu-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackonprem-workervcpu-2d240eb028d9405
  name: openshift-openstackonprem-workervcpu-2d240eb028d9405
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackonprem-workervcpu-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackonprem-workervcpu-professional-33
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackonprem-workervcpu-professional
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstack|openstackonprem",
                        distribution=~"openshift4",
                        vshn_service_level="professional",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 43 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackonprem-workervcpu-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackonprem-workervcpu-standard-34
  name: openshift-openstackonprem-workervcpu-standard-34
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackonprem-workervcpu-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackonprem-workervcpu-standard-34
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackonprem-workervcpu-standard
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstack|openstackonprem",
                        distribution=~"openshift4",
                        vshn_service_level="standard",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 44 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-openstackonprem-workervcpu-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-openstackonprem-workervcpu-zero-35
  name: openshift-openstackonprem-workervcpu-zero-35
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-openstackonprem-workervcpu-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-openstackonprem-workervcpu-zero-35
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-openstackonprem-workervcpu-zero
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"openstack|openstackonprem",
                        distribution=~"openshift4",
                        vshn_service_level="zero",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 45 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vspherecsp-workervcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vspherecsp-workervcpu-besteffort-36
  name: openshift-vspherecsp-workervcpu-besteffort-36
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vspherecsp-workervcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vspherecsp-workervcpu-besteffort-36
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vspherecsp-workervcpu-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"vspherecsp",
                        distribution=~"openshift4",
                        vshn_service_level="best_effort",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 46 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vspherecsp-workervcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vspherecsp-workervcpu-guaranteed-37
  name: openshift-vspherecsp-workervcpu-guaranteed-37
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vspherecsp-workervcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vspherecsp-workervcpu-guaranteed-37
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vspherecsp-workervcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"vspherecsp",
                        distribution=~"openshift4",
                        vshn_service_level="guaranteed_availability",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 47 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vspherecsp-workervcpu-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vspherecsp-workervcpu-premium-38
  name: openshift-vspherecsp-workervcpu-premium-38
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vspherecsp-workervcpu-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vspherecsp-workervcpu-premium-38
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vspherecsp-workervcpu-premium
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"vspherecsp",
                        distribution=~"openshift4",
                        vshn_service_level="premium",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 48 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vspherecsp-workervcpu-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vspherecsp-workervcpu-professional-39
  name: openshift-vspherecsp-workervcpu-professional-39
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vspherecsp-workervcpu-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vspherecsp-workervcpu-professional-39
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vspherecsp-workervcpu-professional
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"vspherecsp",
                        distribution=~"openshift4",
                        vshn_service_level="professional",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 49 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vspherecsp-workervcpu-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vspherecsp-workervcpu-standard-40
  name: openshift-vspherecsp-workervcpu-standard-40
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vspherecsp-workervcpu-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vspherecsp-workervcpu-standard-40
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vspherecsp-workervcpu-standard
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"vspherecsp",
                        distribution=~"openshift4",
                        vshn_service_level="standard",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 50 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vspherecsp-workervcpu-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vspherecsp-workervcpu-zero-41
  name: openshift-vspherecsp-workervcpu-zero-41
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vspherecsp-workervcpu-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vspherecsp-workervcpu-zero-41
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vspherecsp-workervcpu-zero
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"vspherecsp",
                        distribution=~"openshift4",
                        vshn_service_level="zero",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vsphereonprem-workervcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vsphereonprem-workervcpu-besteffort-42
  name: openshift-vsphereonprem-workervcpu-besteffort-42
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vsphereonprem-workervcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vsphereonprem-workervcpu-besteffort-42
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vsphereonprem-workervcpu-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"none|vsphere|vsphereonprem",
                        distribution=~"openshift4",
                        vshn_service_level="best_effort",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vsphereonprem-workervcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vsphereonprem-workervcpu-guaranteed-43
  name: openshift-vsphereonprem-workervcpu-guaranteed-43
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vsphereonprem-workervcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vsphereonprem-workervcpu-guaranteed-43
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vsphereonprem-workervcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"none|vsphere|vsphereonprem",
                        distribution=~"openshift4",
                        vshn_service_level="guaranteed_availability",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 12 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vsphereonprem-workervcpu-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vsphereonprem-workervcpu-premium-44
  name: openshift-vsphereonprem-workervcpu-premium-44
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vsphereonprem-workervcpu-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vsphereonprem-workervcpu-premium-44
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vsphereonprem-workervcpu-premium
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"none|vsphere|vsphereonprem",
                        distribution=~"openshift4",
                        vshn_service_level="premium",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 13 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vsphereonprem-workervcpu-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vsphereonprem-workervcpu-professional-45
  name: openshift-vsphereonprem-workervcpu-professional-45
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vsphereonprem-workervcpu-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vsphereonprem-workervcpu-professional-45
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vsphereonprem-workervcpu-professional
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"none|vsphere|vsphereonprem",
                        distribution=~"openshift4",
                        vshn_service_level="professional",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 14 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vsphereonprem-workervcpu-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vsphereonprem-workervcpu-standard-46
  name: openshift-vsphereonprem-workervcpu-standard-46
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vsphereonprem-workervcpu-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vsphereonprem-workervcpu-standard-46
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vsphereonprem-workervcpu-standard
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"none|vsphere|vsphereonprem",
                        distribution=~"openshift4",
                        vshn_service_level="standard",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 15 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-vsphereonprem-workervcpu-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-vsphereonprem-workervcpu-zero-47
  name: openshift-vsphereonprem-workervcpu-zero-47
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-vsphereonprem-workervcpu-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-vsphereonprem-workervcpu-zero-47
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-vsphereonprem-workervcpu-zero
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"none|vsphere|vsphereonprem",
                        distribution=~"openshift4",
                        vshn_service_level="zero",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 16 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-xelon-workervcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-xelon-workervcpu-besteffort-48
  name: openshift-xelon-workervcpu-besteffort-48
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-xelon-workervcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-xelon-workervcpu-besteffort-48
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-xelon-workervcpu-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"xelon",
                        distribution=~"openshift4",
                        vshn_service_level="best_effort",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 17 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-xelon-workervcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-xelon-workervcpu-guaranteed-49
  name: openshift-xelon-workervcpu-guaranteed-49
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-xelon-workervcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-xelon-workervcpu-guaranteed-49
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-xelon-workervcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"xelon",
                        distribution=~"openshift4",
                        vshn_service_level="guaranteed_availability",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 18 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-xelon-workervcpu-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-xelon-workervcpu-premium-50
  name: openshift-xelon-workervcpu-premium-50
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-xelon-workervcpu-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-xelon-workervcpu-premium-50
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-xelon-workervcpu-premium
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"xelon",
                        distribution=~"openshift4",
                        vshn_service_level="premium",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 19 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-xelon-workervcpu-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-xelon-workervcpu-professional-51
  name: openshift-xelon-workervcpu-professional-51
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-xelon-workervcpu-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-xelon-workervcpu-professional-51
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-xelon-workervcpu-professional
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"xelon",
                        distribution=~"openshift4",
                        vshn_service_level="professional",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 20 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-xelon-workervcpu-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-xelon-workervcpu-standard-52
  name: openshift-xelon-workervcpu-standard-52
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-xelon-workervcpu-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-xelon-workervcpu-standard-52
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-xelon-workervcpu-standard
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"xelon",
                        distribution=~"openshift4",
                        vshn_service_level="standard",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 21 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-xelon-workervcpu-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-xelon-workervcpu-zero-53
  name: openshift-xelon-workervcpu-zero-53
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-xelon-workervcpu-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-xelon-workervcpu-zero-53
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-xelon-workervcpu-zero
                - name: AR_QUERY
                  value: |
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id, role) (
                          # Get the node vCPUs (do not remove `cpu and `core` from the
                          # `by` clause, otherwise the vCPU amount is incorrect)
                          max by (cluster_id, instance, cpu, core) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (role, instance, cluster_id) (
                                  label_join(kube_node_role{role="app"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        cloud_provider=~"xelon",
                        distribution=~"openshift4",
                        vshn_service_level="zero",
                      }
                    )
                    , "flavor_display", "Container Platform", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-vcpu-%(cluster_id)s-%(role)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    %(flavor_display)s - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 22 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: cilium-advanced-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: cilium-advanced-besteffort-0
  name: cilium-advanced-besteffort-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: cilium-advanced-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: cilium-advanced-besteffort-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: cilium-advanced-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id) (
                          # Get the node vCPUs
                          max by (cluster_id, instance, core, cpu) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (cluster_id, instance, role) (
                                  label_join(kube_node_role{role=~"app|storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        vshn_service_level=~"best_effort|zero|standard",
                        cilium_addons=~".*advanced_networking.*"
                      }
                    )
                    , "cilium_addon", "advanced_networking", "", "")
                    , "addon_display", "Advanced Networking and Observability", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "%(cilium_addon)s-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "Cilium %(addon_display)s
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: cilium-advanced-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: cilium-advanced-guaranteed-1
  name: cilium-advanced-guaranteed-1
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: cilium-advanced-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: cilium-advanced-guaranteed-1
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: cilium-advanced-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id) (
                          # Get the node vCPUs
                          max by (cluster_id, instance, core, cpu) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (cluster_id, instance, role) (
                                  label_join(kube_node_role{role=~"app|storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        vshn_service_level=~"guaranteed_availability|professional",
                        cilium_addons=~".*advanced_networking.*"
                      }
                    )
                    , "cilium_addon", "advanced_networking", "", "")
                    , "addon_display", "Advanced Networking and Observability", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "%(cilium_addon)s-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "Cilium %(addon_display)s
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: cilium-tetragon-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: cilium-tetragon-besteffort-2
  name: cilium-tetragon-besteffort-2
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: cilium-tetragon-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: cilium-tetragon-besteffort-2
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: cilium-tetragon-besteffort
                - name: AR_QUERY
                  value: |
                    label_replace(
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id) (
                          # Get the node vCPUs
                          max by (cluster_id, instance, core, cpu) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (cluster_id, instance, role) (
                                  label_join(kube_node_role{role=~"app|storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        vshn_service_level=~"best_effort|zero|standard",
                        cilium_addons=~".*tetragon.*"
                      }
                    )
                    , "cilium_addon", "tetragon", "", "")
                    , "addon_display", "Tetragon", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "%(cilium_addon)s-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "Cilium %(addon_display)s
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 12 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: cilium-tetragon-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: cilium-tetragon-guaranteed-3
  name: cilium-tetragon-guaranteed-3
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: cilium-tetragon-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: cilium-tetragon-guaranteed-3
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: cilium-tetragon-guaranteed
                - name: AR_QUERY
                  value: |
                    label_replace(
                    label_replace(
                    # Calculates vCPUs for app nodes of a cluster
                    # Max values over one hour.
                    max_over_time(
                      # Sum the vCPUs by cluster
                      sum by(cluster_id) (
                          # Get the node vCPUs
                          max by (cluster_id, instance, core, cpu) (node_cpu_info)
                          # Limit to worker nodes only
                          * on (cluster_id, instance) group_left(role) (
                              # node_cpu_info and kube_node_role use different labels to identify the node.
                              max by (cluster_id, instance, role) (
                                  label_join(kube_node_role{role=~"app|storage"}, "instance", "", "node")
                              )
                          )
                      )[59m:1m]
                    )
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) max by (cluster_id, sales_order) (
                      appuio_managed_info{
                        vshn_service_level=~"guaranteed_availability|professional",
                        cilium_addons=~".*tetragon.*"
                      }
                    )
                    , "cilium_addon", "tetragon", "", "")
                    , "addon_display", "Tetragon", "", "")
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "%(cilium_addon)s-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "Cilium %(addon_display)s
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 13 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-awseks-vcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-awseks-vcpu-besteffort-0
  name: kubernetes-awseks-vcpu-besteffort-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-awseks-vcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-awseks-vcpu-besteffort-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-awseks-vcpu-besteffort
                - name: AR_QUERY
                  value: |
                    max_over_time(sum by(cluster_id) (node_cpu_info)[59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        sales_order!="NONE",
                        sales_order!="TERMINATED",
                        cloud_provider="aws",
                        distribution="eks",
                        vshn_service_level="best_effort",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-vcpu-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-awseks-vcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-awseks-vcpu-guaranteed-1
  name: kubernetes-awseks-vcpu-guaranteed-1
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-awseks-vcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-awseks-vcpu-guaranteed-1
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-awseks-vcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    max_over_time(sum by(cluster_id) (node_cpu_info)[59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        sales_order!="NONE",
                        sales_order!="TERMINATED",
                        cloud_provider="aws",
                        distribution="eks",
                        vshn_service_level="guaranteed_availability",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-vcpu-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-azureaks-vcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-azureaks-vcpu-besteffort-2
  name: kubernetes-azureaks-vcpu-besteffort-2
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-azureaks-vcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-azureaks-vcpu-besteffort-2
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-azureaks-vcpu-besteffort
                - name: AR_QUERY
                  value: |
                    max_over_time(sum by(cluster_id) (node_cpu_info)[59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        sales_order!="NONE",
                        sales_order!="TERMINATED",
                        cloud_provider="azure",
                        distribution="aks",
                        vshn_service_level="best_effort",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-vcpu-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 12 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-azureaks-vcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-azureaks-vcpu-guaranteed-3
  name: kubernetes-azureaks-vcpu-guaranteed-3
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-azureaks-vcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-azureaks-vcpu-guaranteed-3
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-azureaks-vcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    max_over_time(sum by(cluster_id) (node_cpu_info)[59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        sales_order!="NONE",
                        sales_order!="TERMINATED",
                        cloud_provider="azure",
                        distribution="aks",
                        vshn_service_level="guaranteed_availability",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-vcpu-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 13 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-exoscalesks-vcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-exoscalesks-vcpu-besteffort-4
  name: kubernetes-exoscalesks-vcpu-besteffort-4
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-exoscalesks-vcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-exoscalesks-vcpu-besteffort-4
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-exoscalesks-vcpu-besteffort
                - name: AR_QUERY
                  value: |
                    max_over_time(sum by(cluster_id) (node_cpu_info)[59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        sales_order!="NONE",
                        sales_order!="TERMINATED",
                        cloud_provider="exoscale",
                        distribution="sks",
                        vshn_service_level="best_effort",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-vcpu-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 14 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-exoscalesks-vcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-exoscalesks-vcpu-guaranteed-5
  name: kubernetes-exoscalesks-vcpu-guaranteed-5
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-exoscalesks-vcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-exoscalesks-vcpu-guaranteed-5
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-exoscalesks-vcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    max_over_time(sum by(cluster_id) (node_cpu_info)[59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        sales_order!="NONE",
                        sales_order!="TERMINATED",
                        cloud_provider="exoscale",
                        distribution="sks",
                        vshn_service_level="guaranteed_availability",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-vcpu-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 15 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-googlegke-vcpu-besteffort
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-googlegke-vcpu-besteffort-6
  name: kubernetes-googlegke-vcpu-besteffort-6
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-googlegke-vcpu-besteffort
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-googlegke-vcpu-besteffort-6
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-googlegke-vcpu-besteffort
                - name: AR_QUERY
                  value: |
                    max_over_time(sum by(cluster_id) (node_cpu_info)[59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        sales_order!="NONE",
                        sales_order!="TERMINATED",
                        cloud_provider="google",
                        distribution="gke",
                        vshn_service_level="best_effort",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-vcpu-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 16 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-googlegke-vcpu-guaranteed
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-googlegke-vcpu-guaranteed-7
  name: kubernetes-googlegke-vcpu-guaranteed-7
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-googlegke-vcpu-guaranteed
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-googlegke-vcpu-guaranteed-7
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-googlegke-vcpu-guaranteed
                - name: AR_QUERY
                  value: |
                    max_over_time(sum by(cluster_id) (node_cpu_info)[59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        sales_order!="NONE",
                        sales_order!="TERMINATED",
                        cloud_provider="google",
                        distribution="gke",
                        vshn_service_level="guaranteed_availability",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-vcpu-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_49_440b0fa7
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 17 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-hyperscaler-cluster-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-hyperscaler-cluster-premium-0
  name: kubernetes-hyperscaler-cluster-premium-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-hyperscaler-cluster-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-hyperscaler-cluster-premium-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-hyperscaler-cluster-premium
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                            distribution!="rke2",
                            distribution!="rancher",
                            sales_order!="TERMINATED",
                            sales_order!="NONE",
                            vshn_service_level="premium",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-hyperscaler-cluster-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-hyperscaler-cluster-professional-1
  name: kubernetes-hyperscaler-cluster-professional-1
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-hyperscaler-cluster-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-hyperscaler-cluster-professional-1
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-hyperscaler-cluster-professional
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                            distribution!="rke2",
                            distribution!="rancher",
                            sales_order!="TERMINATED",
                            sales_order!="NONE",
                            vshn_service_level="professional",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-hyperscaler-cluster-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-hyperscaler-cluster-standard-2
  name: kubernetes-hyperscaler-cluster-standard-2
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-hyperscaler-cluster-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-hyperscaler-cluster-standard-2
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-hyperscaler-cluster-standard
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                            distribution!="rke2",
                            distribution!="rancher",
                            sales_order!="TERMINATED",
                            sales_order!="NONE",
                            vshn_service_level="standard",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 12 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-hyperscaler-cluster-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-hyperscaler-cluster-zero-3
  name: kubernetes-hyperscaler-cluster-zero-3
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-hyperscaler-cluster-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-hyperscaler-cluster-zero-3
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-hyperscaler-cluster-zero
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                            distribution!="rke2",
                            distribution!="rancher",
                            sales_order!="TERMINATED",
                            sales_order!="NONE",
                            vshn_service_level="zero",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 13 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-hyperscaler-node-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-hyperscaler-node-premium-0
  name: kubernetes-hyperscaler-node-premium-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-hyperscaler-node-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-hyperscaler-node-premium-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-hyperscaler-node-premium
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      count by(cluster_id) (group by (cluster_id,node) (kube_node_labels))
                    [59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        distribution!="rke2",
                        distribution!="rancher",
                        sales_order!="TERMINATED",
                        sales_order!="NONE",
                        vshn_service_level="premium",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-node-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_191_55730e52
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-hyperscaler-node-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-hyperscaler-node-professional-1
  name: kubernetes-hyperscaler-node-professional-1
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-hyperscaler-node-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-hyperscaler-node-professional-1
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-hyperscaler-node-professional
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      count by(cluster_id) (group by (cluster_id,node) (kube_node_labels))
                    [59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        distribution!="rke2",
                        distribution!="rancher",
                        sales_order!="TERMINATED",
                        sales_order!="NONE",
                        vshn_service_level="professional",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-node-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_191_55730e52
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-hyperscaler-node-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-hyperscaler-node-standard-2
  name: kubernetes-hyperscaler-node-standard-2
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-hyperscaler-node-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-hyperscaler-node-standard-2
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-hyperscaler-node-standard
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      count by(cluster_id) (group by (cluster_id,node) (kube_node_labels))
                    [59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        distribution!="rke2",
                        distribution!="rancher",
                        sales_order!="TERMINATED",
                        sales_order!="NONE",
                        vshn_service_level="standard",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-node-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_191_55730e52
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 12 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-hyperscaler-node-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-hyperscaler-node-zero-3
  name: kubernetes-hyperscaler-node-zero-3
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-hyperscaler-node-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-hyperscaler-node-zero-3
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-hyperscaler-node-zero
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      count by(cluster_id) (group by (cluster_id,node) (kube_node_labels))
                    [59m:1m])
                    # Pull in the APPUiO managed info labels
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                        distribution!="rke2",
                        distribution!="rancher",
                        sales_order!="TERMINATED",
                        sales_order!="NONE",
                        vshn_service_level="zero",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "cloud_k8s-node-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_191_55730e52
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 13 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-cluster-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-cluster-premium-0
  name: openshift-cloudscale-cluster-premium-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-cluster-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-cluster-premium-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-cluster-premium
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"cloudscale",
                          vshn_service_level="premium",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-cluster-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-cluster-professional-1
  name: openshift-cloudscale-cluster-professional-1
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-cluster-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-cluster-professional-1
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-cluster-professional
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"cloudscale",
                          vshn_service_level="professional",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-cluster-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-cluster-standard-2
  name: openshift-cloudscale-cluster-standard-2
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-cluster-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-cluster-standard-2
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-cluster-standard
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"cloudscale",
                          vshn_service_level="standard",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 12 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-cloudscale-cluster-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-cloudscale-cluster-zero-3
  name: openshift-cloudscale-cluster-zero-3
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-cloudscale-cluster-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-cloudscale-cluster-zero-3
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-cloudscale-cluster-zero
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"cloudscale",
                          vshn_service_level="zero",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 13 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-cluster-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-cluster-premium-4
  name: openshift-exoscale-cluster-premium-4
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-cluster-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-cluster-premium-4
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-cluster-premium
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"exoscale",
                          vshn_service_level="premium",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 14 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-cluster-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-cluster-professional-5
  name: openshift-exoscale-cluster-professional-5
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-cluster-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-cluster-professional-5
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-cluster-professional
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"exoscale",
                          vshn_service_level="professional",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 15 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-cluster-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-cluster-standard-6
  name: openshift-exoscale-cluster-standard-6
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-cluster-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-cluster-standard-6
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-cluster-standard
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"exoscale",
                          vshn_service_level="standard",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 16 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-exoscale-cluster-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-exoscale-cluster-zero-7
  name: openshift-exoscale-cluster-zero-7
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-exoscale-cluster-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-exoscale-cluster-zero-7
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-exoscale-cluster-zero
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"exoscale",
                          vshn_service_level="zero",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 17 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-onprem-cluster-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-onprem-cluster-premium-8
  name: openshift-onprem-cluster-premium-8
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-onprem-cluster-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-onprem-cluster-premium-8
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-onprem-cluster-premium
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"vsphere|none",
                          vshn_service_level="premium",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 18 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-onprem-cluster-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-onprem-cluster-professional-9
  name: openshift-onprem-cluster-professional-9
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-onprem-cluster-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-onprem-cluster-professional-9
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-onprem-cluster-professional
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"vsphere|none",
                          vshn_service_level="professional",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 19 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-onprem-cluster-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-onprem-cluster-standard-10
  name: openshift-onprem-cluster-standard-10
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-onprem-cluster-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-onprem-cluster-standard-10
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-onprem-cluster-standard
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"vsphere|none",
                          vshn_service_level="standard",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 20 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-onprem-cluster-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-onprem-cluster-zero-11
  name: openshift-onprem-cluster-zero-11
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-onprem-cluster-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-onprem-cluster-zero-11
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-onprem-cluster-zero
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"vsphere|none",
                          vshn_service_level="zero",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 21 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-xelon-cluster-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-xelon-cluster-premium-12
  name: openshift-xelon-cluster-premium-12
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-xelon-cluster-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-xelon-cluster-premium-12
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-xelon-cluster-premium
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"xelon",
                          vshn_service_level="premium",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 22 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-xelon-cluster-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-xelon-cluster-professional-13
  name: openshift-xelon-cluster-professional-13
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-xelon-cluster-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-xelon-cluster-professional-13
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-xelon-cluster-professional
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"xelon",
                          vshn_service_level="professional",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 23 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-xelon-cluster-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-xelon-cluster-standard-14
  name: openshift-xelon-cluster-standard-14
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-xelon-cluster-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-xelon-cluster-standard-14
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-xelon-cluster-standard
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"xelon",
                          vshn_service_level="standard",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 24 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: openshift-xelon-cluster-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: openshift-xelon-cluster-zero-15
  name: openshift-xelon-cluster-zero-15
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: openshift-xelon-cluster-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: openshift-xelon-cluster-zero-15
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: openshift-xelon-cluster-zero
                - name: AR_QUERY
                  value: |
                    # Calculates number of clusters per cluster. Always returns 1.
                    # Max values over one hour.
                    max_over_time(
                      # Use aggregation to drop labels of no interest.
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          cloud_provider=~"xelon",
                          vshn_service_level="zero",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "ocp-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed OpenShift
                    - Cluster: %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-openshift-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 25 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-iaas-cluster-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-iaas-cluster-premium-0
  name: kubernetes-iaas-cluster-premium-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-iaas-cluster-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-iaas-cluster-premium-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-iaas-cluster-premium
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          sales_order!="TERMINATED",
                          sales_order!="NONE",
                          distribution=~"rancher|rke2",
                          vshn_service_level="premium",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "rke-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-iaas-cluster-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-iaas-cluster-professional-1
  name: kubernetes-iaas-cluster-professional-1
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-iaas-cluster-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-iaas-cluster-professional-1
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-iaas-cluster-professional
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          sales_order!="TERMINATED",
                          sales_order!="NONE",
                          distribution=~"rancher|rke2",
                          vshn_service_level="professional",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "rke-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-iaas-cluster-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-iaas-cluster-standard-2
  name: kubernetes-iaas-cluster-standard-2
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-iaas-cluster-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-iaas-cluster-standard-2
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-iaas-cluster-standard
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          sales_order!="TERMINATED",
                          sales_order!="NONE",
                          distribution=~"rancher|rke2",
                          vshn_service_level="standard",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "rke-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 12 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-iaas-cluster-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-iaas-cluster-zero-3
  name: kubernetes-iaas-cluster-zero-3
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-iaas-cluster-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-iaas-cluster-zero-3
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-iaas-cluster-zero
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      group by(cluster_id, sales_order) (
                        appuio_managed_info{
                          sales_order!="TERMINATED",
                          sales_order!="NONE",
                          distribution=~"rancher|rke2",
                          vshn_service_level="zero",
                        }
                      )[59m:1m]
                    )
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "rke-cluster-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_53_4a7e8f3e
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 13 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-iaas-node-premium
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-iaas-node-premium-0
  name: kubernetes-iaas-node-premium-0
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-iaas-node-premium
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-iaas-node-premium-0
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-iaas-node-premium
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      count by(cluster_id) (
                        kube_node_labels
                        * on(node) group_left() (max by (node) (kube_node_role{role="worker"}))
                      )[59m:1m]
                    )
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                      sales_order!="TERMINATED",
                      sales_order!="NONE",
                      distribution=~"rke2|rancher",
                      vshn_service_level="premium",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "rke-node-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_191_55730e52
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 10 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-iaas-node-professional
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-iaas-node-professional-1
  name: kubernetes-iaas-node-professional-1
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-iaas-node-professional
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-iaas-node-professional-1
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-iaas-node-professional
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      count by(cluster_id) (
                        kube_node_labels
                        * on(node) group_left() (max by (node) (kube_node_role{role="worker"}))
                      )[59m:1m]
                    )
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                      sales_order!="TERMINATED",
                      sales_order!="NONE",
                      distribution=~"rke2|rancher",
                      vshn_service_level="professional",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "rke-node-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_191_55730e52
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 11 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-iaas-node-standard
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-iaas-node-standard-2
  name: kubernetes-iaas-node-standard-2
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-iaas-node-standard
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-iaas-node-standard-2
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-iaas-node-standard
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      count by(cluster_id) (
                        kube_node_labels
                        * on(node) group_left() (max by (node) (kube_node_role{role="worker"}))
                      )[59m:1m]
                    )
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                      sales_order!="TERMINATED",
                      sales_order!="NONE",
                      distribution=~"rke2|rancher",
                      vshn_service_level="standard",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "rke-node-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_191_55730e52
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 12 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
---
apiVersion: batch/v1
kind: CronJob
metadata:
  annotations:
    product-id: kubernetes-iaas-node-zero
  labels:
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-reporting
    app.kubernetes.io/part-of: syn
    name: kubernetes-iaas-node-zero-3
  name: kubernetes-iaas-node-zero-3
  namespace: appuio-reporting-aldebaran
spec:
  failedJobsHistoryLimit: 768
  jobTemplate:
    metadata:
      annotations:
        product-id: kubernetes-iaas-node-zero
      labels:
        app.kubernetes.io/managed-by: commodore
        app.kubernetes.io/name: appuio-reporting
        app.kubernetes.io/part-of: syn
        cron-job-name: kubernetes-iaas-node-zero-3
    spec:
      template:
        metadata:
          labels:
            app.kubernetes.io/managed-by: commodore
            app.kubernetes.io/name: appuio-reporting
            app.kubernetes.io/part-of: syn
        spec:
          containers:
            - args:
                - appuio-reporting report --timerange 1h --begin=$(date -d "now -3
                  hours" -u +"%Y-%m-%dT%H:00:00Z") --repeat-until=$(date -u -Iseconds)
              command:
                - sh
                - -c
              env:
                - name: AR_ODOO_OAUTH_TOKEN_URL
                  valueFrom:
                    secretKeyRef:
                      key: token_endpoint
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: client_id
                      name: odoo-credentials
                - name: AR_ODOO_OAUTH_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: client_secret
                      name: odoo-credentials
                - name: AR_ODOO_URL
                - name: AR_PROM_URL
                  valueFrom:
                    secretKeyRef:
                      key: url
                      name: prom-url
                - name: AR_PRODUCT_ID
                  value: kubernetes-iaas-node-zero
                - name: AR_QUERY
                  value: |
                    max_over_time(
                      count by(cluster_id) (
                        kube_node_labels
                        * on(node) group_left() (max by (node) (kube_node_role{role="worker"}))
                      )[59m:1m]
                    )
                    * on(cluster_id) group_left(sales_order) appuio_managed_info{
                      sales_order!="TERMINATED",
                      sales_order!="NONE",
                      distribution=~"rke2|rancher",
                      vshn_service_level="zero",
                    }
                - name: AR_INSTANCE_JSONNET
                  value: local labels = std.extVar("labels"); "rke-node-%(cluster_id)s"
                    % labels
                - name: AR_ITEM_GROUP_DESCRIPTION_JSONNET
                  value: 'local labels = std.extVar("labels"); "APPUiO Managed - Cluster:
                    %(cluster_id)s" % labels'
                - name: AR_UNIT_ID
                  value: uom_uom_191_55730e52
                - name: AR_ORG_ID
                  value: appuio-managed-kubernetes-services-billing
              image: ghcr.io/appuio/appuio-reporting:v0.2.2
              name: backfill
              resources: {}
          initContainers: []
          restartPolicy: OnFailure
  schedule: 13 * * * *
  startingDeadlineSeconds: 180
  successfulJobsHistoryLimit: 3
  suspend: false
